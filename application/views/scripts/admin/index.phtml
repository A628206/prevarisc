<div style="text-align: center">

    <p><img src="/favicon.ico" width="125px" /></p>

    <?php if(!empty($this->version_prevarisc)) : ?>
        <br>
    <p class="lead">
        Version
        <?php echo $this->version_prevarisc ?>
        <?php if(!empty($this->revision_prevarisc_local)) : ?>
            <span id="update_available" class='avis' style='background-color: #3a87ad; font-size: .7em; display: none;'>Mise à jour disponible sur SDIS62/prevarisc</span>
        <?php else : ?>
            <span class='avis' style='background-color: red; font-size: .7em;'>Erreur lors de la récupération de la version courante</span>
        <?php endif ?>
    </p>
    <?php endif ?>

</div>

<div class="panel panel-default" style="width: 100%; margin-bottom: 20px;">
    <div class="panel-heading">Configuration</div>
        <div class="panel-body">
            <dl class='dl-horizontal' >
                <dt>Clé IGN</dt>
                <dd>
                <p><?php echo $this->key_ign != null ? $this->key_ign : 'Aucune clé' ?></p>
                </dd>

                <dt>Clé Google MAP</dt>
                <dd>
                <p><?php echo $this->key_googlemap != null ? $this->key_googlemap : 'Aucune clé' ?></p>
                </dd>

                <dt>Authentification</dt>
                <dd>
                <p><?php echo $this->authentification ?></p>
                </dd>

                <dt>Base utilisée</dt>
                <dd>
                <p><em><?php echo $this->dbname ?></em> sur <em><?php echo $this->db_url ?></em></p>
                </dd>

                <dt>Cache</dt>
                <dd>
                <?php if ($this->cache_enabled): ?>
                    <p><?php echo $this->cache_adapter ?></p>
                    <p><?php echo $this->cache_url ?></p>
                    <p><?php echo $this->cache_lifetime ?> sec de durée de vie</p>
                <?php else: ?>
                    <p>Désactivé</p>
                <?php endif ?>
                </dd>

                <dt>HTTP API</dt>
                <dd>
                <p><?php echo $this->api_enabled ? 'Activé' : 'Désactivé' ?></p>
                </dd>

                <dt>Proxy HTTP</dt>
                <dd>
                <p><?php echo $this->proxy_enabled != 1 ? 'Désactivé' : 'Activé' ?></p>
                </dd>

                <dt>Plugins Tiers</dt>
                <dd>
                <p><?php echo $this->third_party_plugins ? $this->third_party_plugins : 'Aucuns' ?></p>
                </dd>
            </dl>
        </div>
    </div>
</div>

<?php if(!empty($this->branch_prevarisc)) : ?>
<script>
    // On récupère la version actuelle et on la compare au dernier commit de la
    // branche courante sur le dépôt Github.
    $.getJSON("https://api.github.com/repos/SDIS62/prevarisc/git/refs/heads/<?php echo $this->branch_prevarisc ?>", function(data) {
        if(data.object.sha != '<?php echo $this->revision_prevarisc_local ?>') {
            $("#update_available").show();
        }
    });
</script>
<?php endif ?>
